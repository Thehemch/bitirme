<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ«’ Zeytin DashboardlarÄ±</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="/static/css/custom.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top shadow-sm">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center fw-bold text-success" href="/">
      <img src="/static/img/logo.png" alt="Logo" class="logo-img me-2" />
      ERKAN ZEYTÄ°NCÄ°LÄ°K
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="/">ANASAYFA</a></li>
        <li class="nav-item"><a class="nav-link active text-success" href="/dashboard">DASHBOARD</a></li>
        <li class="nav-item"><a class="nav-link" href="/tahmin">TAHMÄ°NLEME</a></li>
        <li class="nav-item"><a class="nav-link" href="/akilli_harita">AKILLI HARÄ°TA</a></li>
        <li class="nav-item"><a class="nav-link" href="#">RAPOR</a></li>
        <li class="nav-item"><a class="nav-link" href="#">CONTACT</a></li>
      </ul>
      <a class="btn btn-success ms-3" href="#">Get Started</a>
    </div>
  </div>
</nav>

<!-- DASHBOARD PANEL -->
<section class="pt-5" style="margin-top: 90px;">
  <div class="container">
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
      <div class="mb-3 mb-md-0">
        <h2 class="fw-bold text-success">ğŸ«’ Zeytin Dashboard Paneli ğŸ“Š</h2>
        <p class="text-muted">Zeytin Ã¼retim, tÃ¼ketim ve ticaret verilerine hÄ±zlÄ± eriÅŸim saÄŸlayÄ±n.</p>
      </div>
      <div>
        <select id="dashboardCategory" class="form-select" style="width: 250px;" onchange="changeDashboardCategory()">
          <option value="zeytin" selected>ğŸ«’ Zeytin DashboardlarÄ±</option>
          <option value="zeytinyagi">ğŸ¾ ZeytinyaÄŸÄ± DashboardlarÄ±</option>
        </select>
        
        
        
      </div>
    </div>
    <div class="row g-4 mb-4">
      <!-- En Az Ä°thalat -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm p-3">
          <i class="fa-solid fa-arrow-down-wide-short fa-2x text-success mb-2"></i>
          <h6>En Az Ä°thalat Yapan Ãœlke</h6>
          <p id="zeytin-en-az-ithalat" class="fw-bold">YÃ¼kleniyor...</p>
        </div>
      </div>
    
      <!-- En Az TÃ¼ketim -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm p-3">
          <i class="fa-solid fa-utensils fa-2x text-success mb-2"></i>
          <h6>En Az TÃ¼ketim Yapan Ãœlke</h6>
          <p id="zeytin-en-az-tuketim" class="fw-bold">YÃ¼kleniyor...</p>
        </div>
      </div>
    
      <!-- En Fazla Ä°hracat -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm p-3">
          <i class="fa-solid fa-plane-departure fa-2x text-success mb-2"></i>
          <h6>En Fazla Ä°hracat Yapan Ãœlke</h6>
          <p id="zeytin-en-fazla-ihracat" class="fw-bold">YÃ¼kleniyor...</p>
        </div>
      </div>
    
      <!-- En Fazla Ãœretim -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm p-3">
          <i class="fa-solid fa-seedling fa-2x text-success mb-2"></i>
          <h6>En Fazla Ãœretim Yapan Ãœlke</h6>
          <p id="zeytin-en-fazla-uretim" class="fw-bold">YÃ¼kleniyor...</p>
        </div>
      </div>
    </div>
    
    <div id="dashboardCards" class="row g-4">
<!-- BURAYA 8 ADET KART VE 2 ADET INFO-LINE GELECEK -->
        <!-- Kart 1 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-chart-line fa-2x text-success me-3"></i>
              <h5 class="mb-0">Son 5 YÄ±l Toplam Zeytin Ä°hracatÄ±</h5>
            </div>
            <p>Ãœlkelerin 2020-2024 yÄ±llarÄ± arasÄ±ndaki toplam zeytin ihracat verileri.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('son_5_yil_toplam_zeytin_ihracati', 'result-1')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-1"></canvas>
            </div>
          </div>
        </div>
      
        <!-- Kart 2 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-percent fa-2x text-success me-3"></i>
              <h5 class="mb-0">YÄ±l 24 Ä°hracatÄ±nÄ±n Toplam Ä°hracata OranÄ±</h5>
            </div>
            <p>2024 yÄ±lÄ±nda gerÃ§ekleÅŸen ihracatÄ±n toplam ihracattaki yÃ¼zdesel oranÄ±.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('yil_2024_toplam_zeytin_ihracata_orani', 'result-2')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-2"></canvas>
            </div>
          </div>
        </div>
      
        <!-- Ä°hracat ArtÄ±ÅŸ OranÄ± Kutusu -->
        <div class="w-100">
          <div class="info-line text-center p-3 my-3 border border-success rounded">ğŸ“ˆ 2024 Ä°hracat
           <strong id="ihracat-artis-orani">YÃ¼kleniyor...</strong>
          </div>
        </div>
      
        <!-- Kart 3 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-globe fa-2x text-success me-3"></i>
              <h5 class="mb-0">Son 5 YÄ±l Toplam Zeytin Ä°thalatÄ±</h5>
            </div>
            <p>Ãœlkelerin 2020-2024 yÄ±llarÄ± arasÄ±nda yaptÄ±ÄŸÄ± toplam zeytin ithalat verileri.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('son_5_yil_toplam_zeytin_ithalati', 'result-3')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-3"></canvas>
            </div>
          </div>
        </div>
      
        <!-- Kart 4 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-arrow-trend-up fa-2x text-success me-3"></i>
              <h5 class="mb-0">Son 5 YÄ±lda Zeytin Ä°thalatÄ±nda YÃ¼zdesel ArtÄ±ÅŸ</h5>
            </div>
            <p>Son 5 yÄ±lda zeytin ithalatÄ±ndaki yÃ¼zdesel deÄŸiÅŸimlerin analizi.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('son_5_yil_zeytin_ithalat_yuzdesel_artis', 'result-4')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-4"></canvas>
            </div>
          </div>
        </div>
      
        <!-- Ä°thalat ArtÄ±ÅŸ OranÄ± Kutusu -->
        <div class="w-100">
          <div class="info-line text-center p-3 my-3 border border-success rounded">ğŸ“ˆ 2024 Ä°thalat
          <strong id="ithalat-artis-orani">YÃ¼kleniyor...</strong>
          </div>
        </div>
      
        <!-- Kart 5 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-ranking-star fa-2x text-success me-3"></i>
              <h5 class="mb-0">Son 3 YÄ±lda En Ã‡ok TÃ¼keten 5 Ãœlke</h5>
            </div>
            <p>Son 3 yÄ±lda en yÃ¼ksek zeytin tÃ¼ketimi gerÃ§ekleÅŸtiren 5 Ã¼lke analizi.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('son_3_yilda_en_cok_zeytin_tuketimi_yapan_5_ulke', 'result-5')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-5"></canvas>
            </div>
          </div>
        </div>
      
        <!-- Kart 6 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-chart-pie fa-2x text-success me-3"></i>
              <h5 class="mb-0">YÄ±l 24 TÃ¼ketiminin Toplam TÃ¼ketime OranÄ±</h5>
            </div>
            <p>2024 yÄ±lÄ± tÃ¼ketiminin son 5 yÄ±l iÃ§indeki toplam tÃ¼ketime oranÄ±.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('yil_2024_toplam_zeytin_tuketime_orani', 'result-6')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-6"></canvas>
            </div>
          </div>
        </div>
        <div class="w-100">
          <div class="info-line text-center p-3 my-3 border border-success rounded">ğŸ“ˆ 2024 TÃ¼ketim
          <strong id="tuketim-artis-orani">YÃ¼kleniyor...</strong>
          </div>
        </div>
      
        <!-- Kart 7 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-warehouse fa-2x text-success me-3"></i>
              <h5 class="mb-0">Son 5 YÄ±l Toplam Zeytin Ãœretimi</h5>
            </div>
            <p>Ãœlkelerin son 5 yÄ±ldaki toplam zeytin Ã¼retim performanslarÄ±.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('son_5_yil_toplam_zeytin_uretimi', 'result-7')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-7"></canvas>
            </div>
          </div>
        </div>
      
        <!-- Kart 8 -->
        <div class="col-md-6">
          <div class="card p-4 h-100 shadow-sm">
            <div class="d-flex align-items-center mb-3">
              <i class="fa-solid fa-arrow-up-right-dots fa-2x text-success me-3"></i>
              <h5 class="mb-0">Son 5 YÄ±lda Zeytin Ãœretiminde YÃ¼zdesel ArtÄ±ÅŸ</h5>
            </div>
            <p>Ãœretim rakamlarÄ±ndaki yÄ±llÄ±k yÃ¼zdesel artÄ±ÅŸlarÄ±n analizi.</p>
            <button class="btn btn-outline-success" onclick="fetchDashboardData('son_5_yil_uretim_yuzdesel_artis', 'result-8')">DetaylarÄ± GÃ¶r</button>
            <div class="chart-wrapper">
              <canvas id="chart-8"></canvas>
            </div>
          </div>
        </div>
        <div class="w-100">
          <div class="info-line text-center p-3 my-3 border border-success rounded">ğŸ“ˆ 2024 Ãœretim
          <strong id="uretim-artis-orani">YÃ¼kleniyor...</strong> 
          </div>
        </div>
      
      </div>
      

      

    </div>

  </div>
</section>

<!-- FOOTER -->
<footer>
  HazÄ±rlayan: Hamza ERKAN | DEÃœ YÃ¶netim BiliÅŸim Sistemleri Â© 2025
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
let myCharts = {};

function getChartType(resultDivId) {
  const chartTypeMap = {
    'result-1': 'bar',
    'result-2': 'pie',
    'result-3': 'bar',
    'result-4': 'line',
    'result-5': 'bar',
    'result-6': 'pie',
    'result-7': 'bar',
    'result-8': 'line'
  };
  return chartTypeMap[resultDivId] || 'bar';
}

function fetchDashboardData(procedureName, resultDivId) {
  fetch('/get_dashboard_data', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ procedure: procedureName })
  })
  .then(response => response.json())
  .then(data => {
    console.log('Gelen veri:', data);

    let chartId = 'chart-' + resultDivId.split('-')[1];

    if (myCharts[chartId]) {
      myCharts[chartId].destroy();
    }

    let labels = data.map(row => row[0]);
    let values = data.map(row => row[1]);

    const ctx = document.getElementById(chartId).getContext('2d');
    const chartType = getChartType(resultDivId);

    myCharts[chartId] = new Chart(ctx, {
      type: chartType,
      data: {
        labels: labels,
        datasets: [{
          label: 'DeÄŸerler',
          data: values,
          backgroundColor: [
  'rgba(40, 167, 69, 0.6)',  // yeÅŸil
  'rgba(0, 123, 255, 0.6)',  // mavi
  'rgba(255, 193, 7, 0.6)',  // sarÄ±
  'rgba(220, 53, 69, 0.6)',  // kÄ±rmÄ±zÄ±
  'rgba(23, 162, 184, 0.6)', // turkuaz
  'rgba(108, 117, 125, 0.6)',// gri
  'rgba(255, 99, 132, 0.6)', // pembe
  'rgba(75, 192, 192, 0.6)', // aÃ§Ä±k turkuaz
  'rgba(153, 102, 255, 0.6)',// mor
  'rgba(255, 159, 64, 0.6)', // turuncu
  'rgba(100, 149, 237, 0.6)',// gÃ¶k mavisi
  'rgba(255, 215, 0, 0.6)'   // altÄ±n sarÄ±sÄ±
],
borderColor: [
  'rgba(40, 167, 69, 1)',
  'rgba(0, 123, 255, 1)',
  'rgba(255, 193, 7, 1)',
  'rgba(220, 53, 69, 1)',
  'rgba(23, 162, 184, 1)',
  'rgba(108, 117, 125, 1)',
  'rgba(255, 99, 132, 1)',
  'rgba(75, 192, 192, 1)',
  'rgba(153, 102, 255, 1)',
  'rgba(255, 159, 64, 1)',
  'rgba(100, 149, 237, 1)',
  'rgba(255, 215, 0, 1)'
]
,
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: chartType === 'pie' ? {} : { y: { beginAtZero: true } }
      }
    });
  })
  .catch(error => {
    console.error('Hata oluÅŸtu:', error);
  });
}

function fetchInfoData(procedureName, elementId) {
  fetch('/get_info_data', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ procedure: procedureName })
  })
  .then(response => response.json())
  .then(data => {
    console.log('Gelen INFO veri:', data);
    if (data !== null) {
      document.getElementById(elementId).innerText = `DeÄŸiÅŸim OranÄ±: %${data}`;
    } else {
      document.getElementById(elementId).innerText = 'Veri bulunamadÄ±.';
    }
  })
  .catch(error => {
    console.error('Hata:', error);
    document.getElementById(elementId).innerText = 'Hata oluÅŸtu.';
  });
}

function fetchInfoCountry(procedureName, elementId) {
  fetch('/get_info_data', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ procedure: procedureName })
  })
  .then(response => response.json())
  .then(data => {
    console.log('Gelen ÃœLKE ve DeÄŸer:', data);
    if (data !== null && Array.isArray(data) && data.length >= 2) {
      const ulke = data[0];
      const deger = data[1];
      document.getElementById(elementId).innerText = `${ulke} - ${deger} (bin ton)`;
    } else {
      document.getElementById(elementId).innerText = 'Veri bulunamadÄ±.';
    }
  })
  .catch(error => {
    console.error('Hata:', error);
    document.getElementById(elementId).innerText = 'Hata oluÅŸtu.';
  });
}




function changeDashboardCategory() {
  const selectedCategory = document.getElementById('dashboardCategory').value;

  if (selectedCategory === 'zeytin') {
    window.location.href = '/dashboard';
  } else if (selectedCategory === 'zeytinyagi') {
    window.location.href = '/zeytinyagi_dashboard';
  }
}




// Sayfa aÃ§Ä±lÄ±nca verileri Ã§ek
window.onload = function() {
  // Ã¼st kutucuklar
  // Ãœlke ismi kutularÄ±
  fetchInfoCountry("zeytin_en_az_ithalat_yapan_ulke_2024", "zeytin-en-az-ithalat");
  fetchInfoCountry("zeytin_en_az_tuketim_yapan_ulke_2024", "zeytin-en-az-tuketim");
  fetchInfoCountry("zeytin_en_fazla_ihracat_yapan_ulke_2024", "zeytin-en-fazla-ihracat");
  fetchInfoCountry("zeytin_en_fazla_uretim_yapan_ulke_2024", "zeytin-en-fazla-uretim");





  // Info verilerini Ã§ek
  fetchInfoData("zeytin_ihracat_artis_orani_2024", "ihracat-artis-orani");
  fetchInfoData("zeytin_ithalat_artis_orani_2024", "ithalat-artis-orani");
  fetchInfoData("zeytin_tuketim_artis_orani_2024", "tuketim-artis-orani");
  fetchInfoData("zeytin_uretim_artis_orani_2024", "uretim-artis-orani");

  // Dashboard verilerini Ã§ek
  fetchDashboardData('son_5_yil_toplam_zeytin_ihracati', 'result-1');
  fetchDashboardData('yil_2024_toplam_zeytin_ihracata_orani', 'result-2');
  fetchDashboardData('son_5_yil_toplam_zeytin_ithalati', 'result-3');
  fetchDashboardData('son_5_yil_zeytin_ithalat_yuzdesel_artis', 'result-4');
  fetchDashboardData('son_3_yilda_en_cok_zeytin_tuketimi_yapan_5_ulke', 'result-5');
  fetchDashboardData('yil_2024_toplam_zeytin_tuketime_orani', 'result-6');
  fetchDashboardData('son_5_yil_toplam_zeytin_uretimi', 'result-7');
  fetchDashboardData('son_5_yil_uretim_yuzdesel_artis', 'result-8');
}



</script>

</body>
</html>
